<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Equilibrium Matching</title>

  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-PYVRSFMDRL"></script>
  <script>
    window.dataLayer = window.dataLayer || [];

    function gtag() {
      dataLayer.push(arguments);
    }

    gtag('js', new Date());

    gtag('config', 'G-PYVRSFMDRL');
  </script>

  <link href="https://fonts.googleapis.com/css?family=Google+Sans|Noto+Sans|Castoro"
        rel="stylesheet">

  <link rel="stylesheet" href="./static/css/bulma.min.css">
  <link rel="stylesheet" href="./static/css/bulma-carousel.min.css">
  <link rel="stylesheet" href="./static/css/bulma-slider.min.css">
  <link rel="stylesheet" href="./static/css/fontawesome.all.min.css">
  <link rel="stylesheet"
        href="https://cdn.jsdelivr.net/gh/jpswalsh/academicons@1/css/academicons.min.css">
  <link rel="stylesheet" href="./static/css/index.css">
  <link rel="icon" href="./static/images/favicon.svg">

  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script defer src="./static/js/fontawesome.all.min.js"></script>
  <script src="./static/js/bulma-carousel.min.js"></script>
  <script src="./static/js/bulma-slider.min.js"></script>
  <script src="./static/js/index.js"></script>
</head>
<body>


<section class="hero">
  <div class="hero-body">
    <div class="container is-max-desktop">
      <div class="columns is-centered">
        <div class="column has-text-centered">
          <h1 class="title is-1 publication-title">Equilibrium Matching: Generative Modeling with Implicit Energy-Based Models</h1>
          <div class="is-size-5 publication-authors">
            <span class="author-block">
              <a href="https://raywang4.github.io/">Runqian Wang</a><sup>1</sup>,</span>
            <span class="author-block">
              <a href="https://yilundu.github.io/">Yilun Du</a><sup>2</sup>,</span>
            
          </div>

          <div class="is-size-5 publication-authors">
            <span class="author-block"><sup>1</sup>MIT,</span>
            <span class="author-block"><sup>2</sup>Harvard</span>
          </div>

          <div class="column has-text-centered">
            <div class="publication-links">
              <!-- PDF Link. -->
              <span class="link-block">
                <a href="https://arxiv.org/pdf/2011.12948"
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="fas fa-file-pdf"></i>
                  </span>
                  <span>Paper</span>
                </a>
              </span>
              <span class="link-block">
                <a href="https://arxiv.org/abs/2011.12948"
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="ai ai-arxiv"></i>
                  </span>
                  <span>arXiv</span>
                </a>
              </span>
              
              <!-- Code Link. -->
              <span class="link-block">
                <a href="https://github.com/raywang4/EqM"
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="fab fa-github"></i>
                  </span>
                  <span>Code</span>
                  </a>
              </span>
              
            </div>

          </div>
        </div>
      </div>
    </div>
  </div>
</section>

<section class="hero teaser">
  <div class="container is-max-desktop">
    <div class="item item-toby">
              <video
                poster=""
                id="re10k_8"
                autoplay
                muted
                loop
                playsinline
                height="100%"
                loading="lazy">
                <source src="flow_matching_side_by_side.mp4" type="video/mp4" />
              </video>
            </div>
    <div class="item item-toby">
              <video
                poster=""
                id="re10k_8"
                autoplay
                muted
                loop
                playsinline
                height="100%"
                loading="lazy">
                <source src="eqm_side_by_side.mp4" type="video/mp4" />
              </video>
            </div>
  </div>
</section>



<section class="section">
  <div class="container is-max-desktop">
    <!-- Abstract. -->
    <div class="columns is-centered has-text-centered">
      <div class="column is-four-fifths">
        <h2 class="title is-3">Abstract</h2>
        <div class="content has-text-justified">
          <p>
            We introduce Equilibrium Matching (EqM), a generative modeling framework built from an equilibrium dynamics perspective. 
            EqM discards the non-equilibrium, time-conditional dynamics in traditional diffusion and flow-based generative models 
            and instead learns the equilibrium gradient of an implicit energy landscape. Through this approach, 
            we can adopt an optimization-based sampling process at inference time, where samples are obtained by gradient descent 
            on the learned landscape with adjustable step sizes, adaptive optimizers, and adaptive compute. 
            EqM surpasses the generation performance of diffusion/flow models empirically, achieving an FID of 1.90 on ImageNet 256$\times$256. 
            EqM is also theoretically justified to learn and sample from the data manifold. Beyond generation, EqM is a flexible framework 
            that naturally handles tasks including partially noised image denoising, OOD detection, and image composition. 
            By replacing time-conditional velocities with a unified equilibrium landscape, EqM offers a tighter bridge between 
            flow and energy-based models and a simple route to optimization-driven inference.
          </p>
        </div>
        <br />
        <div class="content has-text-centered">
        <img src="eqm.png"/>   
        </div>
      </div>
    </div>
    <!--/ Abstract. -->
  </div>
</section>

<section class="section">
      <div class="container is-max-desktop">
        <div class="columns is-centered has-text-centered">
          <div class="column is-full-width has-text-justified">
            <h2 class="title is-3 has-text-centered">Generation Performance</h2>
            <div class="content has-text-justified">
              <p>
                Equilibrium Matching is guaranteed to learn the data manifold and produce samples from this manifold using gradient descent. 
                Empirically, Equilibrium Matching achieves 1.90 FID on ImageNet 256x256 generation, 
                outperforming existing diffusion and flow-based counterparts in generation quality. 
                Equilibrium Matching also exhibits strong scaling behavior, exceeding the flow-based counterpart at all tested scales.
              </p>
            </div>
            <br />
            <div class="content has-text-centered">
              <img src="scale.png"/>   
            </div>
            <br />
            <div class="content has-text-centered">
              <img src="process.png"/>   
            </div>
          </div>
        </div>
      </div>
    </section>

  <section class="section">
      <div class="container is-max-desktop">
        <div class="columns is-centered has-text-centered">
          <div class="column is-full-width has-text-justified">
            <h2 class="title is-3 has-text-centered">Optimization-Based Sampling</h2>
            <div class="content has-text-justified">
              <p>
               By learning a single equilibrium dynamics, Equilibrium Matching supports optimization-based sampling, 
                where samples are obtained by gradient descent on the learned landscape. 
                Unlike existing diffusion samplers that integrate along a prescribed trajectory, 
                optimization-based sampling supports different step sizes and adaptive optimizers. 
                Existing gradient optimization techniques such as Nesterov Accelerated Gradient can be naturally adopted to achieve better generation quality. 
                Equilibrium Matching can also allocate inference-time compute adaptively. 
                It adjusts the sampling steps for each sample independently based on gradient norm and can save up to 60\% of function evaluations.les.
              </p>
            </div>
            <br />
            <div class="content has-text-centered">
              <img src="opt.png"/>   
            </div>
          </div>
        </div>
      </div>
    </section>

  <section class="section">
      <div class="container is-max-desktop">
        <div class="columns is-centered has-text-centered">
          <div class="column is-full-width has-text-justified">
            <h2 class="title is-3 has-text-centered">Unique Properties</h2>
            <div class="content has-text-justified">
              <p>
               Equilibrium Matching demonstrates unique properties that traditional diffusion/flow-based models lack. 
                Equilibrium Matching can generate high-quality samples directly from partially noised inputs, 
                whereas flow-based models only perform well when starting with pure noise. 
                Moreover, Equilibrium Matching can perform out-of-distribution (OOD) detection 
                without relying on any external module. We also show that different Equilibrium Matching models 
                can be added together to generate compositional images in a similar way as EBMs. 
                Our results show that Equilibrium Matching offers capabilities unseen in traditional diffusion/flow models.
              </p>
            </div>
            <br />
            <div class="content has-text-centered">
              <img src="unique.png"/>   
            </div>
          </div>
        </div>
      </div>
    </section>
  


<section class="section" id="BibTeX">
  <div class="container is-max-desktop content">
    <h2 class="title">BibTeX</h2>
    <pre><code>@article{park2021nerfies,
  author    = {Park, Keunhong and Sinha, Utkarsh and Barron, Jonathan T. and Bouaziz, Sofien and Goldman, Dan B and Seitz, Steven M. and Martin-Brualla, Ricardo},
  title     = {Nerfies: Deformable Neural Radiance Fields},
  journal   = {ICCV},
  year      = {2021},
}</code></pre>
  </div>
</section>


<footer class="footer">
  <div class="container">
    <div class="content has-text-centered">
      <a class="icon-link"
         href="./static/videos/nerfies_paper.pdf">
        <i class="fas fa-file-pdf"></i>
      </a>
      <a class="icon-link" href="https://github.com/keunhong" class="external-link" disabled>
        <i class="fab fa-github"></i>
      </a>
    </div>
    <div class="columns is-centered">
      <div class="column is-8">
        <div class="content">
          <p>
            This website is licensed under a <a rel="license"
                                                href="http://creativecommons.org/licenses/by-sa/4.0/">Creative
            Commons Attribution-ShareAlike 4.0 International License</a>.
          </p>
          <p>
            This means you are free to borrow the <a
              href="https://github.com/nerfies/nerfies.github.io">source code</a> of this website,
            we just ask that you link back to this page in the footer.
            Please remember to remove the analytics code included in the header of the website which
            you do not want on your website.
          </p>
        </div>
      </div>
    </div>
  </div>
</footer>

</body>
</html>
